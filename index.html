<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vianney Hastings - Photographe & Créateur de sites web</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1a1a1a;
            --secondary: #f8f8f6;
            --accent: #c9a96e;
            --text-light: #666;
            --white: #ffffff;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--primary);
            background: var(--white);
        }

        /* Navigation */
        .nav-horizontal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #eee;
            z-index: 1000;
            padding: 15px 0;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo {
            font-size: 1.4rem;
            font-weight: 500;
            color: var(--primary);
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 20px;
            transition: all 0.3s ease;
            background: none;
            border: none;
        }

        .logo:hover {
            background: var(--accent);
            color: var(--white);
        }

        .nav-menu {
            list-style: none;
            display: flex;
            gap: 1.5rem;
        }

        .nav-menu a {
            color: var(--primary);
            text-decoration: none;
            font-size: 0.85rem;
            font-weight: 400;
            padding: 6px 12px;
            border-radius: 20px;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nav-menu a:hover,
        .nav-menu a.active {
            background: var(--accent);
            color: var(--white);
        }

        /* Hero Section */
        #home {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .hero-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://raw.githubusercontent.com/EmailSortpro/vianneyphotography/main/DSC03748.jpg');
            background-size: cover;
            background-position: center;
            z-index: 1;
        }

        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            z-index: 2;
        }

        .hero-content {
            position: relative;
            z-index: 3;
            text-align: center;
            color: var(--white);
            padding: 0 20px;
        }

        .hero-content h1 {
            font-size: 4.5rem;
            font-weight: 300;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .hero-content p {
            font-size: 1.4rem;
            margin-bottom: 10px;
            font-weight: 300;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .subtitle2 {
            color: var(--accent);
            font-size: 1.2rem;
        }

        .cta-button {
            display: inline-block;
            margin-top: 30px;
            padding: 15px 30px;
            background: var(--accent);
            color: var(--white);
            border: none;
            border-radius: 30px;
            font-weight: 500;
            font-size: 1rem;
            transition: all 0.3s ease;
            text-decoration: none;
            cursor: pointer;
        }

        .cta-button:hover {
            background: var(--primary);
            transform: translateY(-2px);
        }

        /* Sections */
        section {
            padding: 60px 20px;
        }

        .section-title {
            font-size: 3rem;
            font-weight: 300;
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary);
        }

        .section-subtitle {
            font-size: 1.2rem;
            text-align: center;
            color: var(--text-light);
            max-width: 800px;
            margin: 0 auto 40px;
        }

        /* About */
        #about {
            background: var(--secondary);
        }

        .about-content {
            max-width: 1000px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
        }

        .about-text p {
            margin-bottom: 20px;
            color: var(--text-light);
            line-height: 1.8;
        }

        .about-image img {
            width: 100%;
            border-radius: 8px;
        }

        /* Gallery Grid Optimisé */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 10px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .gallery-item {
            position: relative;
            overflow: hidden;
            background: #f0f0f0;
            cursor: pointer;
            aspect-ratio: 1;
            border-radius: 4px;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease, opacity 0.3s ease;
            opacity: 0;
        }

        .gallery-item img.loaded {
            opacity: 1;
        }

        .gallery-item:hover img {
            transform: scale(1.1);
        }

        /* Skeleton loader */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Galerie Modale Améliorée */
        .gallery-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .gallery-modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 1;
        }

        .modal-content {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-image {
            max-width: 100%;
            max-height: 90vh;
            object-fit: contain;
            animation: zoomIn 0.3s ease;
        }

        @keyframes zoomIn {
            from {
                transform: scale(0.8);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 40px;
            font-size: 3rem;
            color: white;
            cursor: pointer;
            transition: transform 0.3s ease;
            z-index: 2001;
        }

        .modal-close:hover {
            transform: rotate(90deg);
        }

        .modal-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 3rem;
            color: white;
            cursor: pointer;
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
            border: none;
            transition: background 0.3s ease;
            user-select: none;
        }

        .modal-nav:hover {
            background: rgba(0, 0, 0, 0.8);
        }

        .modal-prev {
            left: 20px;
        }

        .modal-next {
            right: 20px;
        }

        .modal-counter {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 1rem;
            background: rgba(0, 0, 0, 0.7);
            padding: 8px 16px;
            border-radius: 20px;
        }

        /* Thumbnails en bas */
        .modal-thumbnails {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            overflow-x: auto;
            max-width: 80%;
            padding: 10px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 10px;
        }

        .modal-thumbnail {
            width: 60px;
            height: 60px;
            object-fit: cover;
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.3s ease, transform 0.3s ease;
            border-radius: 4px;
        }

        .modal-thumbnail.active,
        .modal-thumbnail:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        /* Loading spinner */
        .loading-spinner {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        /* Wedding Section */
        #mariage {
            background: var(--white);
        }

        .wedding-intro {
            max-width: 1200px;
            margin: 0 auto 40px;
            text-align: center;
        }

        .four-columns {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .column-item {
            padding: 25px;
            background: var(--secondary);
            border-radius: 12px;
            text-align: center;
        }

        .column-item h3 {
            color: var(--accent);
            margin-bottom: 10px;
        }

        .column-item p {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        /* Reportage */
        #reportage {
            background: var(--secondary);
        }

        /* Web Services */
        #web {
            background: var(--white);
        }

        /* Contact */
        #contact {
            background: var(--secondary);
        }

        .contact-container {
            max-width: 1000px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
        }

        .contact-info h4 {
            color: var(--accent);
            margin-bottom: 10px;
            text-transform: uppercase;
            font-size: 0.9rem;
        }

        .contact-info p {
            color: var(--text-light);
            margin-bottom: 30px;
        }

        .contact-form {
            background: var(--white);
            padding: 40px;
            border-radius: 8px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .submit-btn {
            background: var(--accent);
            color: var(--white);
            padding: 15px 30px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
        }

        /* Mobile */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }
            
            .hero-content h1 {
                font-size: 2.5rem;
            }
            
            .about-content,
            .contact-container {
                grid-template-columns: 1fr;
            }
            
            .gallery-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }

            .modal-thumbnails {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav-horizontal">
        <div class="nav-container">
            <button class="logo" onclick="location.href='#home'">Vianney Hastings</button>
            <ul class="nav-menu">
                <li><a href="#home">Accueil</a></li>
                <li><a href="#about">À propos</a></li>
                <li><a href="#portrait">Portrait</a></li>
                <li><a href="#mariage">Mariage</a></li>
                <li><a href="#reportage">Reportage</a></li>
                <li><a href="#web">Sites Web</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero -->
    <section id="home">
        <div class="hero-background"></div>
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h1>Vianney Hastings</h1>
            <p>Photographe Mariages, Événements, Portraits</p>
            <p class="subtitle2">Créateur de sites web</p>
            <a href="#about" class="cta-button">Découvrir mon travail</a>
        </div>
    </section>

    <!-- À propos -->
    <section id="about">
        <div class="about-content">
            <div class="about-text">
                <h2 class="section-title">À propos</h2>
                <p>Vianney, 30 ans, photographe de passion, originaire de Nantes, j'ai beaucoup voyagé entre l'Amérique du sud, l'Asie et le Royaume-Uni où j'ai résidé pendant 5 ans.</p>
                <p>Mon goût pour le voyage m'a donné cette passion pour la photographie que j'ai envie de partager aujourd'hui. J'ai hâte de pouvoir échanger avec vous et de vous accompagner sur chacun de vos projets.</p>
            </div>
            <div class="about-image">
                <img src="https://raw.githubusercontent.com/EmailSortpro/vianneyphotography/main/Vianney.jpg" alt="Vianney" loading="lazy">
            </div>
        </div>
    </section>

    <!-- Portrait -->
    <section id="portrait">
        <h2 class="section-title">Portraits</h2>
        <p class="section-subtitle">Capturer l'essence de chaque personnalité</p>
        <div class="gallery-grid" id="portrait-gallery"></div>
    </section>

    <!-- Mariage -->
    <section id="mariage">
        <div class="wedding-intro">
            <h2 class="section-title">Mariages</h2>
            <p class="section-subtitle">Votre mariage est unique, chaque instant mérite d'être immortalisé</p>
            <div class="four-columns">
                <div class="column-item">
                    <h3>Préparatifs</h3>
                    <p>Les moments intimes de préparation</p>
                </div>
                <div class="column-item">
                    <h3>Cérémonie</h3>
                    <p>L'échange des vœux capturé avec sensibilité</p>
                </div>
                <div class="column-item">
                    <h3>Réception</h3>
                    <p>L'ambiance festive de votre soirée</p>
                </div>
                <div class="column-item">
                    <h3>Couple</h3>
                    <p>Des portraits romantiques</p>
                </div>
            </div>
        </div>
        <div class="gallery-grid" id="wedding-gallery"></div>
    </section>

    <!-- Reportage -->
    <section id="reportage">
        <h2 class="section-title">Reportages & Architecture</h2>
        <p class="section-subtitle">Raconter des histoires à travers l'objectif</p>
        <div class="gallery-grid" id="reportage-gallery"></div>
    </section>

    <!-- Sites Web -->
    <section id="web">
        <h2 class="section-title">Création de Sites Web</h2>
        <p class="section-subtitle">Sites web personnalisés pour votre activité</p>
        <div class="four-columns">
            <div class="column-item">
                <h3>🔍 Qualification</h3>
                <p>Comprendre vos objectifs</p>
            </div>
            <div class="column-item">
                <h3>🧭 Périmètre</h3>
                <p>Définir les fonctionnalités</p>
            </div>
            <div class="column-item">
                <h3>🛠️ Création</h3>
                <p>Développement et tests</p>
            </div>
            <div class="column-item">
                <h3>🔄 Évolutions</h3>
                <p>Maintenance et mises à jour</p>
            </div>
        </div>
    </section>

    <!-- Contact -->
    <section id="contact">
        <h2 class="section-title">Contact</h2>
        <div class="contact-container">
            <div class="contact-info">
                <h4>Téléphone</h4>
                <p>07 67 28 80 86</p>
                <h4>Email</h4>
                <p>vianneyhastings@gmail.com</p>
                <h4>Localisation</h4>
                <p>Paris et région parisienne</p>
            </div>
            <div class="contact-form">
                <form onsubmit="event.preventDefault(); alert('Message envoyé !');">
                    <div class="form-group">
                        <label>Nom</label>
                        <input type="text" required>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" required>
                    </div>
                    <div class="form-group">
                        <label>Message</label>
                        <textarea rows="5"></textarea>
                    </div>
                    <button type="submit" class="submit-btn">Envoyer</button>
                </form>
            </div>
        </div>
    </section>

    <!-- Gallery Modal -->
    <div class="gallery-modal" id="galleryModal">
        <span class="modal-close" onclick="closeGallery()">&times;</span>
        <div class="modal-content">
            <div class="loading-spinner" id="modalSpinner"></div>
            <button class="modal-nav modal-prev" onclick="navigateGallery(-1)">‹</button>
            <img class="modal-image" id="modalImage" src="" alt="">
            <button class="modal-nav modal-next" onclick="navigateGallery(1)">›</button>
        </div>
        <div class="modal-thumbnails" id="modalThumbnails"></div>
        <div class="modal-counter" id="modalCounter"></div>
    </div>

    <script>
        // Configuration optimisée
        const baseURL = 'https://raw.githubusercontent.com/EmailSortpro/vianneyphotography/main/';
        const imageCache = new Map();
        let currentGallery = [];
        let currentIndex = 0;
        let preloadQueue = [];

        // Optimisation du chargement des images
        class ImageOptimizer {
            constructor() {
                this.loadedImages = new Set();
                this.loadingImages = new Map();
            }

            async loadImage(src, priority = false) {
                if (this.loadedImages.has(src)) {
                    return src;
                }

                if (this.loadingImages.has(src)) {
                    return this.loadingImages.get(src);
                }

                const promise = new Promise((resolve, reject) => {
                    const img = new Image();
                    img.onload = () => {
                        this.loadedImages.add(src);
                        this.loadingImages.delete(src);
                        resolve(src);
                    };
                    img.onerror = () => {
                        this.loadingImages.delete(src);
                        reject();
                    };
                    
                    if (priority) {
                        img.loading = 'eager';
                    } else {
                        img.loading = 'lazy';
                    }
                    
                    img.src = src;
                });

                this.loadingImages.set(src, promise);
                return promise;
            }

            preloadImages(urls) {
                urls.forEach(url => {
                    if (!this.loadedImages.has(url)) {
                        this.loadImage(url, false);
                    }
                });
            }
        }

        const imageOptimizer = new ImageOptimizer();

        // Création optimisée des éléments de galerie
        function createOptimizedGalleryItem(src, index, galleryName) {
            const div = document.createElement('div');
            div.className = 'gallery-item skeleton';
            
            const img = document.createElement('img');
            img.dataset.src = src;
            img.dataset.index = index;
            img.dataset.gallery = galleryName;
            img.alt = `Photo ${index + 1}`;
            
            div.appendChild(img);
            div.onclick = () => openGallery(galleryName, index);
            
            return div;
        }

        // Observer intersection amélioré
        const imageObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    if (img.dataset.src && !img.src) {
                        loadImageWithFallback(img);
                        imageObserver.unobserve(img);
                    }
                }
            });
        }, {
            rootMargin: '100px',
            threshold: 0.01
        });

        // Chargement avec fallback
        async function loadImageWithFallback(img) {
            const src = img.dataset.src;
            try {
                await imageOptimizer.loadImage(src);
                img.src = src;
                img.classList.add('loaded');
                img.parentElement.classList.remove('skeleton');
                
                // Précharger les images suivantes
                const gallery = img.dataset.gallery;
                const index = parseInt(img.dataset.index);
                preloadNearbyImages(gallery, index);
            } catch (error) {
                console.error('Erreur chargement image:', src);
                img.parentElement.style.display = 'none';
            }
        }

        // Préchargement intelligent
        function preloadNearbyImages(galleryName, index) {
            const gallery = galleries[galleryName];
            if (!gallery) return;
            
            const preloadRange = 3;
            const imagesToPreload = [];
            
            for (let i = 1; i <= preloadRange; i++) {
                if (index + i < gallery.length) {
                    imagesToPreload.push(baseURL + gallery[index + i]);
                }
                if (index - i >= 0) {
                    imagesToPreload.push(baseURL + gallery[index - i]);
                }
            }
            
            imageOptimizer.preloadImages(imagesToPreload);
        }

        // Galeries
        const galleries = {
            portrait: [
                'portrait/Alexandra%20and%20Janine.jpg',
                'portrait/Alexandra.jpg',
                'portrait/DSC00045.jpg',
                'portrait/DSC00272-scaled.jpg',
                'portrait/DSC03483.jpg',
                'portrait/DSC03537.jpg',
                'portrait/DSC03805.jpg',
                'portrait/DSC04454.jpg',
                'portrait/DSC04714.jpg',
                'portrait/DSC04822%20-%20Copy.jpg',
                'portrait/DSC04874%20(2)%20-%20Copy.jpg',
                'portrait/DSC05065.jpg',
                'portrait/DSC06155.jpg',
                'portrait/DSC06285%20(1).jpg',
                'portrait/DSC06580.jpg',
                'portrait/DSC07129.jpg',
                'portrait/DSC08608-scaled.jpg',
                'portrait/DSC09922.jpg'
            ],
            wedding: [
                'wedding/DSC00018.jpg',
                'wedding/DSC00053.jpg',
                'wedding/DSC00093%20(1).jpg',
                'wedding/DSC03697%20-%20Copy%20-%20Copy.jpg',
                'wedding/DSC03715.jpg',
                'wedding/DSC03743.jpg',
                'wedding/DSC03747.jpg',
                'wedding/DSC03765.jpg',
                'wedding/DSC03772.jpg',
                'wedding/DSC03792.jpg',
                'wedding/DSC03816.jpg',
                'wedding/DSC03817.jpg',
                'wedding/DSC03876.jpg',
                'wedding/DSC03879.jpg',
                'wedding/DSC03898.jpg',
                'wedding/DSC03924.jpg',
                'wedding/DSC03965.jpg',
                'wedding/DSC03994.jpg',
                'wedding/DSC04019.jpg',
                'wedding/DSC04056.jpg',
                'wedding/DSC05142.jpg',
                'wedding/DSC05188.jpg',
                'wedding/DSC05217.jpg',
                'wedding/DSC05242.jpg',
                'wedding/DSC05250.jpg',
                'wedding/DSC05264.jpg',
                'wedding/DSC05266.jpg',
                'wedding/DSC05283.jpg',
                'wedding/DSC05338.jpg',
                'wedding/DSC05361.jpg',
                'wedding/DSC05451.jpg',
                'wedding/DSC05462.jpg',
                'wedding/DSC09717.jpg',
                'wedding/DSC09731.jpg',
                'wedding/DSC09746.jpg',
                'wedding/DSC09747.jpg',
                'wedding/DSC09750.jpg',
                'wedding/DSC09753.jpg',
                'wedding/DSC09910.jpg',
                'wedding/Wedding%20Ele%20and%20PE%20(1).jpg',
                'wedding/Wedding%20Ele%20and%20PE%20(2).jpg',
                'wedding/Wedding%20Ele%20and%20PE.jpg',
                'wedding/Wedding%20Francois%20et%20Louise%20(1).jpg',
                'wedding/Wedding%20Francois%20et%20Louise%20(2).jpg',
                'wedding/Wedding%20Francois%20et%20Louise%20(5).jpg',
                'wedding/Wedding%20Francois%20et%20Louise%20(7).jpg',
                'wedding/Wedding%20Francois%20et%20Louise.jpg',
                'wedding/WhatsApp%20Image%202020-09-21%20at%2014.42.43.jpeg',
                'wedding/WhatsApp%20Image%202020-09-22%20at%2015.21.45.jpeg',
                'wedding/WhatsApp%20Image%202020-09-22%20at%2015.23.13.jpeg'
            ],
            reportage: [
                'reportage/0.jpg',
                'reportage/1.jpg',
                'reportage/113.jpg',
                'reportage/2.1.jpg',
                'reportage/2.jpg',
                'reportage/21.jpg',
                'reportage/3.jpg',
                'reportage/40.jpg',
                'reportage/50.jpg',
                'reportage/6-2.jpg',
                'reportage/7.jpg',
                'reportage/8.11.jpg',
                'reportage/WhatsApp%20Image%202024-11-06%20at%2010.30.27_8379ed0e.jpg',
                'reportage/WhatsApp%20Image%202024-11-06%20at%2010.30.27_dba4a475.jpg',
                'reportage/WhatsApp%20Image%202024-11-06%20at%2010.30.28_01a1ff6e.jpg',
                'reportage/WhatsApp%20Image%202024-11-06%20at%2010.30.28_069ac2f4.jpg',
                'reportage/WhatsApp%20Image%202024-11-06%20at%2010.30.28_3f6d57e4.jpg',
                'reportage/WhatsApp%20Image%202024-11-06%20at%2010.30.28_4bc78b67.jpg',
                'reportage/WhatsApp%20Image%202024-11-06%20at%2010.30.28_4d7414d7.jpg',
                'reportage/WhatsApp%20Image%202024-11-06%20at%2010.30.28_55211dc9.jpg',
                'reportage/WhatsApp%20Image%202024-11-06%20at%2010.30.28_57d726bb.jpg',
                'reportage/WhatsApp%20Image%202024-11-06%20at%2010.30.28_715f2551.jpg',
                'reportage/WhatsApp%20Image%202024-11-06%20at%2010.30.28_e7b2e9b5.jpg',
                'reportage/WhatsApp%20Image%202024-11-06%20at%2010.30.29_e0978609.jpg'
            ]
        };

        // Chargement des galeries
        function loadGallery(galleryName, containerId) {
            const container = document.getElementById(containerId);
            const images = galleries[galleryName];
            
            if (!container || !images) return;
            
            const fragment = document.createDocumentFragment();
            
            images.forEach((imagePath, index) => {
                const item = createOptimizedGalleryItem(
                    baseURL + imagePath,
                    index,
                    galleryName
                );
                fragment.appendChild(item);
            });
            
            container.appendChild(fragment);
            
            // Observer les images
            container.querySelectorAll('img').forEach(img => {
                imageObserver.observe(img);
            });
        }

        // Système de galerie modale amélioré
        function openGallery(galleryName, index) {
            currentGallery = galleries[galleryName].map(path => baseURL + path);
            currentIndex = index;
            
            const modal = document.getElementById('galleryModal');
            modal.classList.add('active');
            
            updateGalleryView();
            createThumbnails();
            
            // Précharger les images adjacentes
            preloadAdjacentImages();
        }

        function updateGalleryView() {
            const modalImage = document.getElementById('modalImage');
            const spinner = document.getElementById('modalSpinner');
            const counter = document.getElementById('modalCounter');
            
            spinner.style.display = 'block';
            modalImage.style.display = 'none';
            
            const imageSrc = currentGallery[currentIndex];
            
            imageOptimizer.loadImage(imageSrc, true).then(() => {
                modalImage.src = imageSrc;
                modalImage.onload = () => {
                    spinner.style.display = 'none';
                    modalImage.style.display = 'block';
                };
            });
            
            counter.textContent = `${currentIndex + 1} / ${currentGallery.length}`;
            
            // Mettre à jour les thumbnails actifs
            updateActiveThumbnail();
        }

        function createThumbnails() {
            const container = document.getElementById('modalThumbnails');
            container.innerHTML = '';
            
            currentGallery.forEach((src, index) => {
                const thumb = document.createElement('img');
                thumb.className = 'modal-thumbnail';
                thumb.src = src;
                thumb.onclick = () => {
                    currentIndex = index;
                    updateGalleryView();
                };
                
                if (index === currentIndex) {
                    thumb.classList.add('active');
                }
                
                container.appendChild(thumb);
            });
        }

        function updateActiveThumbnail() {
            const thumbs = document.querySelectorAll('.modal-thumbnail');
            thumbs.forEach((thumb, index) => {
                thumb.classList.toggle('active', index === currentIndex);
            });
        }

        function navigateGallery(direction) {
            currentIndex = (currentIndex + direction + currentGallery.length) % currentGallery.length;
            updateGalleryView();
            preloadAdjacentImages();
        }

        function preloadAdjacentImages() {
            const preloadIndices = [
                currentIndex - 2,
                currentIndex - 1,
                currentIndex + 1,
                currentIndex + 2
            ];
            
            preloadIndices.forEach(index => {
                if (index >= 0 && index < currentGallery.length) {
                    imageOptimizer.loadImage(currentGallery[index]);
                }
            });
        }

        function closeGallery() {
            const modal = document.getElementById('galleryModal');
            modal.classList.remove('active');
            
            setTimeout(() => {
                document.getElementById('modalImage').src = '';
                document.getElementById('modalThumbnails').innerHTML = '';
            }, 300);
        }

        // Raccourcis clavier
        document.addEventListener('keydown', (e) => {
            const modal = document.getElementById('galleryModal');
            if (!modal.classList.contains('active')) return;
            
            switch(e.key) {
                case 'Escape':
                    closeGallery();
                    break;
                case 'ArrowLeft':
                    navigateGallery(-1);
                    break;
                case 'ArrowRight':
                    navigateGallery(1);
                    break;
            }
        });

        // Swipe pour mobile
        let touchStartX = 0;
        let touchEndX = 0;

        document.getElementById('galleryModal').addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        });

        document.getElementById('galleryModal').addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    navigateGallery(1); // Swipe left = next
                } else {
                    navigateGallery(-1); // Swipe right = prev
                }
            }
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', () => {
            // Charger les galeries avec priorité
            loadGallery('portrait', 'portrait-gallery');
            
            // Charger les autres galeries après un court délai
            setTimeout(() => {
                loadGallery('wedding', 'wedding-gallery');
                loadGallery('reportage', 'reportage-gallery');
            }, 100);
            
            // Précharger quelques images importantes
            imageOptimizer.preloadImages([
                baseURL + 'DSC03748.jpg',
                baseURL + 'Vianney.jpg'
            ]);
        });

        // Optimisation de la performance
        if ('requestIdleCallback' in window) {
            requestIdleCallback(() => {
                // Précharger plus d'images quand le navigateur est inactif
                const allImages = [
                    ...galleries.portrait.slice(0, 5),
                    ...galleries.wedding.slice(0, 5),
                    ...galleries.reportage.slice(0, 5)
                ].map(path => baseURL + path);
                
                imageOptimizer.preloadImages(allImages);
            });
        }
    </script>
</body>
</html>
